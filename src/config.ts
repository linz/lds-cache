import de from 'dotenv';
import { KxApi } from './kx.js';
de.config();

const apiKey = process.env['KX_API_KEY'];
const cachePrefix = process.env['CACHE_PREFIX'] ?? '';
if (apiKey == null) throw new Error('Missing $KX_API_KEY');
if (cachePrefix == null) throw new Error('Missing $CACHE_PREFIX');

export const kx = new KxApi(apiKey);
/** prefix for where to store the cache, @example `s3://bucketName/prefix` */
export const CachePrefix = cachePrefix;
/** List of Kx datasetIds to monitor and import */
const Monitor = [
  { id: 101290, name: '101290-nz-building-outlines' },
  { id: 103631, name: '103631-nz-river-name-polygons-pilot' },
  { id: 103632, name: '103632-nz-river-name-lines-pilot' },
  { id: 50063, name: '50063-nz-chatham-island-airport-polygons-topo-150k' },
  { id: 50067, name: '50067-nz-chatham-island-bridge-centrelines-topo-150k' },
  { id: 50088, name: '50088-nz-chatham-island-lake-polygons-topo-150k' },
  { id: 50098, name: '50098-nz-chatham-island-river-centrelines-topo-150k' },
  { id: 50099, name: '50099-nz-chatham-island-river-polygons-topo-150k' },
  { id: 50100, name: '50100-nz-chatham-island-road-centrelines-topo-150k' },
  { id: 50103, name: '50103-nz-chatham-island-runway-polygons-topo-150k' },
  { id: 50115, name: '50115-nz-chatham-island-track-centrelines-topo-150k' },
  { id: 50180, name: '50180-nz-railway-centrelines-topo-1250k' },
  { id: 50184, name: '50184-nz-road-centrelines-topo-1250k' },
  { id: 50237, name: '50237-nz-airport-polygons-topo-150k' },
  { id: 50244, name: '50244-nz-bridge-centrelines-topo-150k' },
  { id: 50248, name: '50248-nz-cableway-industrial-centrelines-topo-150k' },
  { id: 50249, name: '50249-nz-cableway-people-centrelines-topo-150k' },
  { id: 50265, name: '50265-nz-dry-dock-polygons-topo-150k' },
  { id: 50269, name: '50269-nz-ferry-crossing-centrelines-topo-150k' },
  { id: 50275, name: '50275-nz-ford-points-topo-150k' },
  { id: 50285, name: '50285-nz-helipad-points-topo-150k' },
  { id: 50293, name: '50293-nz-lake-polygons-topo-150k' },
  { id: 50318, name: '50318-nz-rail-station-points-topo-150k' },
  { id: 50319, name: '50319-nz-railway-centrelines-topo-150k' },
  { id: 50323, name: '50323-nz-reef-polygons-topo-150k' },
  { id: 50329, name: '50329-nz-road-centrelines-topo-150k' },
  { id: 50333, name: '50333-nz-runway-polygons-topo-150k' },
  { id: 50343, name: '50343-nz-shoal-polygons-topo-150k' },
  { id: 50348, name: '50348-nz-ski-lift-centrelines-topo-150k' },
  { id: 50349, name: '50349-nz-ski-tow-centrelines-topo-150k' },
  { id: 50356, name: '50356-nz-spring-points-topo-150k' },
  { id: 50364, name: '50364-nz-track-centrelines-topo-150k' },
  { id: 50366, name: '50366-nz-tunnel-centrelines-topo-150k' },
  { id: 50768, name: '50768-nz-contours-topo-150k' },
  { id: 50772, name: '50772-nz-primary-parcels' },
  { id: 50893, name: '50893-nz-snares-island-tini-heke-island-polygons-topo-125k' },
  { id: 50894, name: '50894-nz-snares-island-tini-heke-lake-polygons-topo-125k' },
  { id: 50896, name: '50896-nz-snares-island-tini-heke-river-centrelines-topo-125k' },
  { id: 50902, name: '50902-nz-kermadec-is-cableway-people-centrelines-topo-125k' },
  { id: 50908, name: '50908-nz-kermadec-is-island-polygons-topo-125k' },
  { id: 50909, name: '50909-nz-kermadec-is-lake-polygons-topo-125k' },
  { id: 50911, name: '50911-nz-kermadec-is-river-centrelines-topo-125k' },
  { id: 50914, name: '50914-nz-kermadec-is-runway-polygons-topo-125k' },
  { id: 50917, name: '50917-nz-kermadec-is-shoal-polygons-topo-125k' },
  { id: 50919, name: '50919-nz-kermadec-is-spring-points-topo-125k' },
  { id: 50921, name: '50921-nz-kermadec-is-track-centrelines-topo-125k' },
  { id: 50932, name: '50932-nz-campbell-island-motu-ihupuku-island-polygons-topo-150k' },
  { id: 50933, name: '50933-nz-campbell-island-motu-ihupuku-lake-polygons-topo-150k' },
  { id: 50934, name: '50934-nz-campbell-island-motu-ihupuku-river-centrelines-topo-150k' },
  { id: 50939, name: '50939-nz-campbell-island-motu-ihupuku-shoal-polygons-topo-150k' },
  { id: 50941, name: '50941-nz-campbell-island-motu-ihupuku-track-centrelines-topo-150k' },
  { id: 50959, name: '50959-nz-auckland-island-island-polygons-topo-150k' },
  { id: 50960, name: '50960-nz-auckland-island-lake-polygons-topo-150k' },
  { id: 50962, name: '50962-nz-auckland-island-river-centrelines-topo-150k' },
  { id: 50969, name: '50969-nz-auckland-island-track-centrelines-topo-150k' },
  { id: 50978, name: '50978-nz-antipodes-island-polygons-topo-125k' },
  { id: 50979, name: '50979-nz-antipodes-island-river-centrelines-topo-125k' },
  { id: 50992, name: '50992-nz-bounty-islands-polygons-topo-125k' },
  { id: 51000, name: '51000-historic-aerial-photos-survey-footprints-crown-1936-2005' },
  { id: 51002, name: '51002-nz-aerial-photo-footprints-mainland-nz-1936-2005-polygons' },
  { id: 51153, name: '51153-nz-coastlines-and-islands-polygons-topo-150k' },
  { id: 52143, name: '52143-tokelau-bridge-centrelines-topo-125k' },
  { id: 52149, name: '52149-tokelau-island-polygons-topo-125k' },
  { id: 52150, name: '52150-tokelau-lagoon-polygons-topo-125k' },
  { id: 52155, name: '52155-tokelau-reef-polygons-topo-125k' },
  { id: 52157, name: '52157-tokelau-road-centrelines-topo-125k' },
  { id: 52161, name: '52161-tokelau-shoal-polygons-topo-125k' },
  { id: 52162, name: '52162-tokelau-track-centrelines-topo-125k' },
  { id: 52181, name: '52181-niue-island-polygons-topo-150k' },
  { id: 52187, name: '52187-niue-reef-polygons-topo-150k' },
  { id: 52188, name: '52188-niue-road-centrelines-topo-150k' },
  { id: 52194, name: '52194-niue-track-centrelines-topo-150k' },
  { id: 52203, name: '52203-cook-islands-island-polygons-topo-150k-zone4' },
  { id: 52205, name: '52205-cook-islands-lagoon-polygons-topo-150k-zone4' },
  { id: 52207, name: '52207-cook-islands-reef-polygons-topo-150k-zone4' },
  { id: 52208, name: '52208-cook-islands-river-centrelines-topo-150k-zone4' },
  { id: 52209, name: '52209-cook-islands-road-centrelines-topo-150k-zone4' },
  { id: 52214, name: '52214-cook-islands-shoal-polygons-topo-150k-zone4' },
  { id: 52215, name: '52215-cook-islands-track-centrelines-topo-150k-zone4' },
  { id: 52222, name: '52222-cook-islands-island-polygons-topo-150k-zone3' },
  { id: 52223, name: '52223-cook-islands-lagoon-polygons-topo-150k-zone3' },
  { id: 52225, name: '52225-cook-islands-reef-polygons-topo-150k-zone3' },
  { id: 52228, name: '52228-cook-islands-shoal-polygons-topo-150k-zone3' },
  { id: 52235, name: '52235-cook-islands-bridge-centrelines-topo-125k-zone4' },
  { id: 52244, name: '52244-cook-islands-drain-centrelines-topo-125k-zone4' },
  { id: 52251, name: '52251-cook-islands-island-polygons-topo-125k-zone4' },
  { id: 52252, name: '52252-cook-islands-lagoon-polygons-topo-125k-zone4' },
  { id: 52253, name: '52253-cook-islands-lake-polygons-topo-125k-zone4' },
  { id: 52261, name: '52261-cook-islands-reef-polygons-topo-125k-zone4' },
  { id: 52264, name: '52264-cook-islands-river-centrelines-topo-125k-zone4' },
  { id: 52265, name: '52265-cook-islands-river-polygons-topo-125k-zone4' },
  { id: 52266, name: '52266-cook-islands-road-centrelines-topo-125k-zone4' },
  { id: 52273, name: '52273-cook-islands-shoal-polygons-topo-125k-zone4' },
  { id: 52281, name: '52281-cook-islands-track-centrelines-topo-125k-zone4' },
  { id: 52293, name: '52293-cook-islands-island-polygons-topo-125k-zone3' },
  { id: 52295, name: '52295-cook-islands-lagoon-polygons-topo-125k-zone3' },
  { id: 52296, name: '52296-cook-islands-lake-polygons-topo-125k-zone3' },
  { id: 52298, name: '52298-cook-islands-reef-polygons-topo-125k-zone3' },
  { id: 52299, name: '52299-cook-islands-river-centrelines-topo-125k-zone3' },
  { id: 52300, name: '52300-cook-islands-road-centrelines-topo-125k-zone3' },
  { id: 52305, name: '52305-cook-islands-shoal-polygons-topo-125k-zone3' },
  { id: 52308, name: '52308-cook-islands-track-centrelines-topo-125k-zone3' },
];

export const Layers = new Map<number, { id: number; name: string }>();
for (const layer of Monitor) Layers.set(layer.id, layer);
